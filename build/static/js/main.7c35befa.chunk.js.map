{"version":3,"sources":["Login.js","TrackSearchResult.js","Player.js","Dashboard.js","useAuth.js","App.js","index.js"],"names":["Login","Container","className","src","alt","href","TrackSearchResult","track","chooseTrack","style","cursor","onClick","albumUrl","title","height","width","artist","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","window","history","pushState","catch","location","timeOut","setTimeout","clearTimeout","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","URLSearchParams","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"4KAIe,SAASA,IACtB,OACE,eAACC,EAAA,EAAD,CAAWC,UAAU,QAArB,UACE,qBAAKC,IAAI,iEAAiEC,IAAI,gBAC9E,mBAAGF,UAAU,wBAAwBG,KAL1B,uTAKX,gC,2BCNS,SAASC,EAAT,GAAkD,IAAtBC,EAAqB,EAArBA,MAAOC,EAAc,EAAdA,YAIhD,OACE,sBAAKN,UAAU,gCAAgCO,MAAO,CAACC,OAAQ,WAC/DC,QALF,WACEH,EAAYD,IAGZ,UAEE,qBAAKJ,IAAKI,EAAMK,SAAUR,IAAKG,EAAMM,MAAOJ,MAAO,CAACK,OAAQ,OAAQC,MAAO,UAC3E,sBAAKb,UAAU,OAAf,UACE,8BAAMK,EAAMM,QACZ,qBAAKX,UAAU,aAAf,SAA6BK,EAAMS,e,YCT5B,SAASC,EAAT,GAA0C,IAAzBC,EAAwB,EAAxBA,YAAaC,EAAW,EAAXA,SAC3C,EAAuBC,oBAAS,GAAhC,mBAAOC,EAAP,KAAYC,EAAZ,KAGA,OAFAC,qBAAU,kBAAMD,GAAQ,KAAM,CAACH,IAE3BD,EACG,cAAC,IAAD,CACPM,MAAON,EACPO,cAAY,EACZC,SAAU,SAAAC,GACJA,EAAMC,WAAWN,GAAQ,IAE/BD,KAAMA,EACNQ,KAAMV,EAAW,CAACA,GAAY,KARN,K,qBCCpBW,EAAa,I,OAAIC,GAAc,CACnCC,SAAU,qCAEG,SAASC,EAAT,GAA4B,IACnCf,ECVO,SAAiBgB,GAC9B,MAAsCd,qBAAtC,mBAAOF,EAAP,KAAoBiB,EAApB,KACA,EAAwCf,qBAAxC,mBAAOgB,EAAP,KAAqBC,EAArB,KACA,EAAkCjB,qBAAlC,mBAAOkB,EAAP,KAAkBC,EAAlB,KA8BA,OA5BAhB,qBAAU,WACRiB,IAAMC,KAAK,8BAA8B,CACvCP,SACCQ,MAAK,SAAAC,GACNR,EAAeQ,EAAIC,KAAK1B,aACxBmB,EAAgBM,EAAIC,KAAKR,cACzBG,EAAaI,EAAIC,KAAKN,WACtBO,OAAOC,QAAQC,UAAU,GAAI,KAAM,QAClCC,OAAM,WACPH,OAAOI,SAAW,SAEnB,CAACf,IAEJX,qBAAU,WACR,GAAIa,GAAiBE,EAArB,CACA,IAAMY,EAAUC,YAAW,WACvBX,IAAMC,KAAK,gCAAgC,CAC3CL,iBACCM,MAAK,SAAAC,GACNR,EAAeQ,EAAIC,KAAK1B,aACxBqB,EAAaI,EAAIC,KAAKN,cACrBU,OAAM,WACPH,OAAOI,SAAW,SAEA,KAAlBX,EAAY,KAChB,OAAO,kBAAMc,aAAaF,OACzB,CAACd,EAAcE,IAEXpB,EDvBamC,CADoB,EAAPnB,MAEjC,EAA2Bd,mBAAS,IAApC,mBAAOkC,EAAP,KAAeC,EAAf,KACA,EAAyCnC,mBAAS,IAAlD,mBAAOoC,EAAP,KAAsBC,EAAtB,KACA,EAAuCrC,qBAAvC,mBAAOsC,EAAP,KAAqBC,EAArB,KACA,EAA2BvC,mBAAS,IAApC,mBAAOwC,EAAP,KAAeC,EAAf,KAEA,SAASrD,EAAYD,GACnBoD,EAAgBpD,GAChBgD,EAAU,IACVM,EAAU,IA2CZ,OAxCAtC,qBAAU,WACJmC,GACJlB,IAAMsB,IAAI,+BAA+B,CACvCC,OAAO,CACLxD,MAAOmD,EAAa7C,MACpBG,OAAQ0C,EAAa1C,UAEtB0B,MAAK,SAAAC,GACNkB,EAAUlB,EAAIC,KAAKgB,aAEpB,CAACF,IAEJnC,qBAAU,WACJL,GACJY,EAAWK,eAAejB,KAC1B,CAACA,IAEHK,qBAAU,WACR,IAAI+B,EAAQ,OAAOG,EAAiB,IACpC,GAAIvC,EAAJ,CAEA,IAAI8C,GAAS,EAgBb,OAfAlC,EAAWmC,aAAaX,GAAQZ,MAAM,SAAAC,GACjCqB,GACHP,EAAiBd,EAAIuB,KAAKC,OAAOC,MAAMC,KAAI,SAAA9D,GACzC,IAAM+D,EAAqB/D,EAAMgE,MAAMC,OAAOC,QAAO,SAACC,EAASC,GAC7D,OAAGA,EAAM7D,OAAS4D,EAAS5D,OAAe6D,EACnCD,IACNnE,EAAMgE,MAAMC,OAAO,IACtB,MAAO,CACLxD,OAAQT,EAAMqE,QAAQ,GAAGC,KACzBhE,MAAON,EAAMsE,KACbC,IAAKvE,EAAMuE,IACXlE,SAAU0D,EAAmBS,YAI5B,kBAAMf,GAAS,MACtB,CAACV,EAAQpC,IAGT,eAACjB,EAAA,EAAD,CAAWC,UAAU,0BAA0BO,MAAO,CAACK,OAAQ,SAA/D,UACE,cAACkE,EAAA,EAAKC,QAAN,CAAcC,KAAK,SAASC,YAAY,uBAAuBC,MAAO9B,EAAQ+B,SAAU,SAAAC,GAAC,OAAI/B,EAAU+B,EAAEC,OAAOH,UAChH,sBAAKlF,UAAU,mBAAmBO,MAAO,CAAC+E,UAAU,QAApD,UAA8DhC,EAAca,KAAI,SAAA9D,GAAK,OACnF,cAACD,EAAD,CAAmBC,MAAOA,EAAuBC,YAAcA,GAAzBD,EAAMuE,QAEpB,IAAzBtB,EAAciC,QACb,qBAAKvF,UAAU,cAAcO,MAAO,CAACiF,WAAY,OAAjD,SAA0D9B,OAE5D,8BAAK,cAAC3C,EAAD,CAAQC,YAAaA,EAAaC,SAAQ,OAAEuC,QAAF,IAAEA,OAAF,EAAEA,EAAcoB,WEtErE,IAAM5C,EAAO,IAAIyD,gBAAgB9C,OAAOI,SAASK,QAAQQ,IAAI,QAM9C8B,MAJf,WACE,OAAO1D,EAAO,cAACD,EAAD,CAAWC,KAAMA,IAAS,cAAClC,EAAD,KCF1C6F,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,U","file":"static/js/main.7c35befa.chunk.js","sourcesContent":["import React from 'react'\r\nimport './firstPage.css'\r\nimport {Container} from \"react-bootstrap\"\r\nconst AUTH_URL = \"https://accounts.spotify.com/authorize?client_id=6a82f3811baf470da9c2c103d4048892&response_type=code&redirect_uri=https://mutiny-music-player.herokuapp.com/&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state\"\r\nexport default function Login() {\r\n  return (\r\n    <Container className=\"login\">\r\n      <img src=\"https://i1.sndcdn.com/avatars-000424488873-wzjyiy-t500x500.jpg\" alt=\"Mutiny Logo\"></img>\r\n      <a className=\"btn btn-danger btn-lg\" href={AUTH_URL}>Login To Mutiny</a>\r\n    </Container>\r\n  )\r\n}\r\n\r\n","import React from 'react'\r\n\r\nexport default function TrackSearchResult({track, chooseTrack}) {\r\n  function handlePlay() {\r\n    chooseTrack(track)\r\n  }\r\n  return (\r\n    <div className=\"d-flex m-2 align-items-center\" style={{cursor: 'pointer'}}\r\n    onClick={handlePlay}>\r\n      <img src={track.albumUrl} alt={track.title} style={{height: '64px', width: '64px'}}/>\r\n      <div className=\"ms-3\">\r\n        <div>{track.title}</div>\r\n        <div className=\"text-muted\">{track.artist}</div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useState , useEffect } from 'react'\r\nimport SpotifyPlayer from 'react-spotify-web-playback'\r\n\r\nexport default function Player({accessToken, trackUri}) {\r\n  const [play,setPlay] = useState(false)\r\n  useEffect(() => setPlay(true),[trackUri])\r\n  \r\n  if(!accessToken) return null\r\n  return <SpotifyPlayer \r\n  token={accessToken}\r\n  showSaveIcon\r\n  callback={state =>{\r\n    if(!state.isPlaying) setPlay(false)\r\n  }}\r\n  play={play}\r\n  uris={trackUri ? [trackUri] : []}\r\n  />\r\n}\r\n","import {useState, useEffect} from 'react'\r\nimport useAuth from './useAuth'\r\nimport TrackSearchResult from './TrackSearchResult'\r\nimport Player from './Player'\r\nimport {Container, Form} from 'react-bootstrap'\r\nimport SpotifyWebApi from 'spotify-web-api-node'\r\nimport axios from 'axios'\r\n\r\nconst spotifyApi = new SpotifyWebApi({\r\n  clientId: \"6a82f3811baf470da9c2c103d4048892\",\r\n})\r\nexport default function Dashboard({code}) {\r\n  const accessToken = useAuth(code)\r\n  const [search, setSearch]= useState(\"\")\r\n  const [searchResults, setSearchResults]= useState([])\r\n  const [playingTrack, setPlayingTrack]= useState()\r\n  const [lyrics, setLyrics]= useState(\"\")\r\n\r\n  function chooseTrack(track) {\r\n    setPlayingTrack(track)\r\n    setSearch('')\r\n    setLyrics(\"\")\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(!playingTrack) return\r\n    axios.get('http://localhost:3001/lyrics',{\r\n      params:{\r\n        track: playingTrack.title,\r\n        artist: playingTrack.artist\r\n      }\r\n    }).then(res => {\r\n      setLyrics(res.data.lyrics)\r\n    })\r\n  }, [playingTrack])\r\n\r\n  useEffect(() => {\r\n    if(!accessToken) return\r\n    spotifyApi.setAccessToken(accessToken)\r\n  },[accessToken])\r\n\r\n  useEffect(() => {\r\n    if(!search) return setSearchResults([])\r\n    if(!accessToken) return\r\n\r\n    let cancel = false\r\n    spotifyApi.searchTracks(search).then( res => {\r\n      if(cancel) return\r\n      setSearchResults(res.body.tracks.items.map(track => {\r\n        const smallestAlbumImage = track.album.images.reduce((smallest,image) => {\r\n          if(image.height < smallest.height) return image\r\n          return smallest\r\n        }, track.album.images[0])\r\n        return {\r\n          artist: track.artists[0].name,\r\n          title: track.name,\r\n          uri: track.uri,\r\n          albumUrl: smallestAlbumImage.url\r\n        }\r\n      }))\r\n    })\r\n    return () => cancel = true\r\n  },[search, accessToken])\r\n\r\n  return (\r\n    <Container className=\"d-flex flex-column py-2\" style={{height: '100vh'}}>\r\n      <Form.Control type=\"search\" placeholder=\"Search Songs/Artists\" value={search} onChange={e => setSearch(e.target.value)}/>\r\n      <div className=\"flex-grow-1 my-2\" style={{overflowY:'auto'}}>{searchResults.map(track => (\r\n        <TrackSearchResult track={track} key={track.uri} chooseTrack= {chooseTrack}/>\r\n      ))}\r\n      {searchResults.length === 0 && (\r\n        <div className=\"text-center\" style={{whiteSpace: \"pre\"}}>{lyrics}</div>\r\n      )}</div>\r\n      <div><Player accessToken={accessToken} trackUri={playingTrack?.uri}/></div>\r\n    </Container>\r\n  )\r\n}\r\n","import {useState,useEffect} from 'react'\r\nimport axios from 'axios'\r\nexport default function useAuth(code) {\r\n  const [accessToken, setAccessToken] = useState()\r\n  const [refreshToken, setRefreshToken] = useState()\r\n  const [expiresIn, setExpiresIn] = useState()\r\n\r\n  useEffect(() => {\r\n    axios.post('http://localhost:3001/login',{\r\n      code,\r\n    }).then(res =>{\r\n      setAccessToken(res.data.accessToken)\r\n      setRefreshToken(res.data.refreshToken)\r\n      setExpiresIn(res.data.expiresIn)\r\n      window.history.pushState({}, null, '/')\r\n    }).catch(() => {\r\n      window.location = '/'\r\n    })\r\n  }, [code])\r\n\r\n  useEffect(() => {\r\n    if(!refreshToken || !expiresIn) return\r\n    const timeOut = setTimeout(() =>{\r\n        axios.post('http://localhost:3001/refresh',{\r\n        refreshToken,\r\n      }).then(res =>{\r\n        setAccessToken(res.data.accessToken)\r\n        setExpiresIn(res.data.expiresIn)\r\n      }).catch(() => {\r\n        window.location = '/'\r\n      })\r\n    }, (expiresIn - 60) * 1000)\r\n    return () => clearTimeout(timeOut)\r\n  }, [refreshToken, expiresIn])\r\n\r\n  return accessToken\r\n}\r\n","import 'bootstrap/dist/css/bootstrap.min.css'\nimport Login from './Login'\nimport Dashboard from './Dashboard'\nconst code = new URLSearchParams(window.location.search).get('code')\n\nfunction App() {\n  return code ? <Dashboard code={code} />:<Login />\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}